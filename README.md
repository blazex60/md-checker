# mdcheck

`mdcheck` は、Markdown文書の品質を高めるためのCLIツールです。
基本的なフォーマットミスの検出を行う「ルールベースチェック」と、ローカルLLM（Ollama）を使用した「AI校正・アドバイス」の2つの機能を備えています。

## 特徴

### 1. ルールベースチェック（高速・常時実行）
Pythonによる静的解析で、以下の問題を瞬時に検出します。
- **見出しのフォーマット**: `#` の後にスペースがないもの（例: `#Title`）を検出
- **行末の余計な空白**: 不要なスペースやタブの混入を警告
- **TODOコメント**: 残ったままの `TODO` や `FIXME` を検出

### 2. AI校正（オプション・ローカルLLM）
Ollamaを経由してローカルLLMを使用し、文脈に応じたアドバイスを提供します。
- **用語・固有名詞の抽出**: 文書内の重要なキーワードをリストアップ
- **表記揺れの検出**: （例: `サーバー` <-> `サーバ`、`mdcheck` <-> `MDChecker` など）
- **改善提案**: 文章の分かりにくい点やスタイルに関する具体的なアドバイス（日本語で出力）

## 必要要件

- Python >= 3.11
- [Ollama](https://ollama.com/) (AI機能を使用する場合)

## インストール

このリポジトリをクローンし、`pip` または `uv` を使用してインストールします。

```bash
# クローン
git clone <repository-url>
cd mdcheck

# pipの場合（開発モード）
pip install -e .

# uvの場合
uv pip install -e .
```

## 使い方

### 基本的なチェック
ファイルパス、またはディレクトリパスを指定して実行します。
ディレクトリを指定した場合、その中の `.md` ファイルすべてをチェックします。

```bash
# 単一ファイル
mdcheck README.md

# ディレクトリ一括
mdcheck docs/
```

実行結果には、フォーマットの問題点が表示されます。

### AIアドバイスの有効化 (`--llm`)
`--llm` オプションを付けると、ルールベースチェックの後にAIによる解析が実行されます。
※ 事前にOllamaを起動しておく必要があります。

```bash
mdcheck README.md --llm
```

### モデルの準備 (`--pull-model`)
デフォルトで使用するモデル（`gemma2:2b`）がローカルにない場合、以下のコマンドでダウンロードできます。

```bash
mdcheck --pull-model
```

## 設定

環境変数を使用することで、Ollamaの接続先や使用モデルを変更できます。`.env` ファイルに記述することも可能です。

| 環境変数 | デフォルト値 | 説明 |
| --- | --- | --- |
| `OLLAMA_HOST` | `http://localhost:11434` | Ollamaサーバーのアドレス |
| `OLLAMA_MODEL` | `gemma2:2b` | 使用するLLMモデル |

**設定例 (.env):**
```ini
OLLAMA_HOST=http://localhost:11434
OLLAMA_MODEL=gemma3:4b
```

## ライセンス

[MIT License](LICENSE)